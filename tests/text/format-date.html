<html>
  <head>
    <title>Date Format</title>
    <script type="text/javascript" src="../../protovis.js"></script>
    <script type="text/javascript" src="../testify.js"></script>
    <link rel="stylesheet" type="text/css" href="../style.css"/>
    <link rel="stylesheet" type="text/css" href="../testify.css"/>
  </head>
  <body>
    <pre id="pre"></pre>
    <script type="text/javascript+protovis">

var i, text = "";

text += ">>> pv.Format.date()\n";
text += "<b>input\texpected\tactual</b>\n";

//i = pv.Format.number()(1);
//text += "1\t1\t" + i + "\n";

var d1 = new Date( Date.UTC( 2001, 2, 10, 17, 16, 18, 13 ) );
var d2 = new Date( Date.UTC( 2006, 7, 10, 15, 5, 8, 123 ) );
var d3 = new Date( Date.UTC( 1961, 0, 3, 1, 51, 10, 1 ) );

var format_tests = [
  [ d1, "%B %e, %Y, %l:%M %P", "March 10, 2001, 5:16 pm" ],
  [ d1, "%m.%d.%y", "03.10.01" ],
  [ d1, "%e, %m, %Y", "10, 03, 2001" ],
  [ d1, "%Y%m%d", "20010310" ],
  [ d1, '%I-%M-%S, %e-%m-%y, it is %w Day', "05-16-18, 10-03-01, it is 6 Day" ],
  [ d1, "%a %b %e %H:%M:%S %Z %Y", "Sat Mar 10 17:16:18 UTC 2001" ],
  [ d1, "%H:%M:%S", "17:16:18" ],
  [ d2, "%d", "10" ],
  [ d2, "%a", "Thu" ],
  [ d2, "%e", "10" ],
  [ d2, "%A", "Thursday" ],
  [ d2, "%u", "4" ],
  [ d2, "%w", "4" ],
  [ d2, "%j", "222" ],
  [ d2, "%V", "32" ],
  [ d2, "%B", "August" ],
  [ d2, "%m", "08" ],
  [ d2, "%b", "Aug" ],
  [ d2, "%h", "Aug" ],
  [ d2, "%G", "2006" ],
  [ d2, "%Y", "2006" ],
  [ d2, "%y", "06" ],
  [ d2, "%P", "pm" ],
  [ d2, "%p", "PM" ],
  [ d2, "%l", "3" ],
  [ d2, "%I", "03" ],
  [ d2, "%H", "15" ],
  [ d2, "%M", "05" ],
  [ d2, "%S", "08" ],
  [ d2, "%f", "123" ],
  [ d2, "%Z", "UTC" ],
  [ d2, "%z", "+0000" ],
  [ d2, "%Y-%m-%dT%H:%M:%S.%f%z", "2006-08-10T15:05:08.123+0000" ],
  [ d2, "%a, %e %b %Y %H:%M:%S %z", "Thu, 10 Aug 2006 15:05:08 +0000" ],
  [ d2, "%s", "1155222308" ],
  [ d3, "%d", "03" ],
  [ d3, "%a", "Tue" ],
  [ d3, "%e", " 3" ],
  [ d3, "%A", "Tuesday" ],
  [ d3, "%u", "2" ],
  [ d3, "%w", "2" ],
  [ d3, "%j", "003" ],
  [ d3, "%V", "01" ],
  [ d3, "%B", "January" ],
  [ d3, "%m", "01" ],
  [ d3, "%b", "Jan" ],
  [ d3, "%G", "1961" ],
  [ d3, "%Y", "1961" ],
  [ d3, "%y", "61" ],
  [ d3, "%P", "am" ],
  [ d3, "%p", "AM" ],
  [ d3, "%l", "1" ],
  [ d3, "%I", "01" ],
  [ d3, "%H", "01" ],
  [ d3, "%M", "51" ],
  [ d3, "%S", "10" ],
  [ d3, "%f", "001" ],
  [ d3, "%Z", "UTC" ],
  [ d3, "%z", "+0000" ],
  [ d3, "%Y-%m-%dT%H:%M:%S.%f%z", "1961-01-03T01:51:10.001+0000" ],
  [ d3, "%a, %d %b %Y %H:%M:%S %z", "Tue, 03 Jan 1961 01:51:10 +0000" ],
  [ d3, "%s", "-283817329" ],
  [ new Date(2005, 0, 1), "%G-W%V-%u", "2004-W53-6" ],
  [ new Date(2005, 0, 2), "%G-W%V-%u", "2004-W53-7" ],
  [ new Date(2005,11,31), "%G-W%V-%u", "2005-W52-6" ],
  [ new Date(2007, 0, 1), "%G-W%V-%u", "2007-W01-1" ],
  [ new Date(2007,11,30), "%G-W%V-%u", "2007-W52-7" ],
  [ new Date(2007,11,31), "%G-W%V-%u", "2008-W01-1" ],
  [ new Date(2008, 0, 1), "%G-W%V-%u", "2008-W01-2" ],
  [ new Date(2008,11,29), "%G-W%V-%u", "2009-W01-1" ],
  [ new Date(2008,11,31), "%G-W%V-%u", "2009-W01-3" ],
  [ new Date(2009, 0, 1), "%G-W%V-%u", "2009-W01-4" ],
  [ new Date(2009,11,31), "%G-W%V-%u", "2009-W53-4" ],
  [ new Date(2010, 0, 3), "%G-W%V-%u", "2009-W53-7" ],
  [ new Date(2009,11,31), "%G-W%V-%u", "2009-W53-4" ],
  [ new Date(2010, 0, 1), "%G-W%V-%u", "2009-W53-5" ],
  [ new Date(2010, 0, 2), "%G-W%V-%u", "2009-W53-6" ],
  [ new Date(2010, 0, 3), "%G-W%V-%u", "2009-W53-7" ],
  [ new Date(2008,11,28), "%G-W%V-%u", "2008-W52-7" ],
  [ new Date(2008,11,29), "%G-W%V-%u", "2009-W01-1" ],
  [ new Date(2008,11,30), "%G-W%V-%u", "2009-W01-2" ],
  [ new Date(2008,11,31), "%G-W%V-%u", "2009-W01-3" ],
  [ new Date(2009, 0, 1), "%G-W%V-%u", "2009-W01-4" ],
  [ new Date(1262304000000), "%YQ%q", "2010Q1"],
  [ new Date(1270080000000), "%YQ%q", "2010Q2"],
  [ new Date(1277942400000), "%YQ%q", "2010Q3"],
  [ new Date(1285891200000), "%YQ%q", "2010Q4"],
  [ new Date(2001,7,10), "%Y-%j", "2001-222"],
];

parse_tests = [
  [ new Date( 984244560000), "%B %e, %Y, %l:%M %P", "March 10, 2001, 5:16 pm" ],
  [ new Date( 984182400000), "%m.%d.%y", "03.10.01" ],
  [ new Date( 984182400000), "%e, %m, %Y", "10, 03, 2001" ],
  [ new Date( 984182400000), "%Y%m%d", "20010310" ],
  [ new Date( 984201378000), '%I-%M-%S, %e-%m-%y, it is %w Day', "05-16-18, 10-03-01, it is 6 Day" ],
  [ new Date( 984244578000), "%a %b %e %H:%M:%S %Z %Y", "Sat Mar 10 17:16:18 UTC 2001" ],
  [ d2, "%Y-%m-%dT%H:%M:%S.%f%z", "2006-08-10T15:05:08.123+0000" ],
  [ new Date(1155222308000), "%a, %e %b %Y %H:%M:%S %z", "Thu, 10 Aug 2006 15:05:08 +0000" ],
  [ new Date(1155222308000), "%s", "1155222308" ],
  [ d3, "%Y-%m-%dT%H:%M:%S.%f%z", "1961-01-03T01:51:10.001+0000" ],
  [ new Date(-283817330000), "%a, %d %b %Y %H:%M:%S %z", "Tue, 03 Jan 1961 01:51:10 +0000" ],
  [ new Date(-283817329000), "%s", "-283817329" ],
  [ new Date(1308835616204), "%Y-%m-%dT%H:%M:%S.%f%z", "2011-06-23T13:26:56.204110Z" ],
  [ new Date(2011,7,23), "%Y-%B-%e", "2011-August-23" ],
  [ new Date(1261353600000), "%G-W%V", "2009-W52"],
  [ new Date(1262563200000), "%G-W%V", "2010-W01"],
  [ new Date( 914803200000), "%G-W%V", "1998-W53"],
  [ new Date(-1956787200000), "%G-W%V", "1908-W01"],
  [ new Date(-1956528000000), "%G-W%V-%u", "1908-W01-4"],
  [ new Date(-1956441601000), "%G-W%V-%u %H:%M:%S", "1908-W01-4 23:59:59"],
  [ new Date(2005, 0, 1), "%G-W%V-%u", "2004-W53-6" ],
  [ new Date(2005, 0, 2), "%G-W%V-%u", "2004-W53-7" ],
  [ new Date(2005,11,31), "%G-W%V-%u", "2005-W52-6" ],
  [ new Date(2007, 0, 1), "%G-W%V-%u", "2007-W01-1" ],
  [ new Date(2007,11,30), "%G-W%V-%u", "2007-W52-7" ],
  [ new Date(2007,11,31), "%G-W%V-%u", "2008-W01-1" ],
  [ new Date(2008, 0, 1), "%G-W%V-%u", "2008-W01-2" ],
  [ new Date(2008,11,29), "%G-W%V-%u", "2009-W01-1" ],
  [ new Date(2008,11,31), "%G-W%V-%u", "2009-W01-3" ],
  [ new Date(2009, 0, 1), "%G-W%V-%u", "2009-W01-4" ],
  [ new Date(2009,11,31), "%G-W%V-%u", "2009-W53-4" ],
  [ new Date(2010, 0, 3), "%G-W%V-%u", "2009-W53-7" ],
  [ new Date(2009,11,31), "%G-W%V-%u", "2009-W53-4" ],
  [ new Date(2010, 0, 1), "%G-W%V-%u", "2009-W53-5" ],
  [ new Date(2010, 0, 2), "%G-W%V-%u", "2009-W53-6" ],
  [ new Date(2010, 0, 3), "%G-W%V-%u", "2009-W53-7" ],
  [ new Date(2008,11,28), "%G-W%V-%u", "2008-W52-7" ],
  [ new Date(2008,11,29), "%G-W%V-%u", "2009-W01-1" ],
  [ new Date(2008,11,30), "%G-W%V-%u", "2009-W01-2" ],
  [ new Date(2008,11,31), "%G-W%V-%u", "2009-W01-3" ],
  [ new Date(2009, 0, 1), "%G-W%V-%u", "2009-W01-4" ],
  [ new Date(1262304000000), "%YQ%q", "2010Q1"],
  [ new Date(1270080000000), "%YQ%q", "2010Q2"],
  [ new Date(1277942400000), "%YQ%q", "2010Q3"],
  [ new Date(1285891200000), "%YQ%q", "2010Q4"],
  [ new Date(2001,7,10), "%Y-%j", "2001-222"],
];

// formatter
text += format_tests.map(function (test) {
  i = pv.Format.date(test[1])(test[0]);
  return test[1] + "\t" + test[2] + "\t" + i;
}).join('\n') + "\n";

// parser
text += parse_tests.map(function (test) {
  i = pv.Format.date(test[1]).parse(test[2]);
  return test[2] + "\t" + JSON.stringify(test[0]).slice(1,-1) + 
                   "\t" + JSON.stringify(i).slice(1,-1);
}).join('\n') + "\n";


testify(text);

    </script>
  </body>
</html>
